# District Officer API Documentation

This document outlines the API endpoints for managing District Officers (role ID 5).

## Base URL
`https://plp-api.moeys.gov.kh/api/v1`

## Authentication
All endpoints require a valid JWT token in the Authorization header:
`Authorization: Bearer <token>`

## Registration Workflow
To fully register a new District Officer and assign them to schools, follow these two steps:

### Step 1: Register User Account
Create the user account with the District Officer role (ID 5).
- **Endpoint**: `POST /users/register/district-officer` (Public endpoint, no auth required)
- **Request Body**:
```json
{
  "username": "officer_01",
  "password": "password123",
  "first_name": "Sophea",
  "last_name": "Chan",
  "date_of_birth": "1985-05-15",
  "gender": "MALE",
  "email": "sophea@example.com", // Optional
  "phone": "0123456789" // Optional
}
```
- **Response**: Returns the created user object. **Note the `id` from the response.**

### Step 2: Assign Schools (Create District Officer Record)
Link the newly created user to specific schools.
- **Endpoint**: `POST /district-officers`
- **Role Required**: ADMIN, DISTRICT
- **Request Body**:
```json
{
  "userId": 123, // The ID from Step 1
  "schoolIds": [101, 102, 103],
  "status": "ACTIVE"
}
```

---

## 1. Create District Officer (Assign Schools)
Links an *existing* user (who must have role ID 5) to schools.

- **Endpoint**: `POST /district-officers`
- **Role Required**: ADMIN, DISTRICT
- **Request Body**:
```json
{
  "userId": 12345,
  "schoolIds": [100, 101, 102],
  "status": "ACTIVE" // Optional, defaults to ACTIVE. Values: ACTIVE, INACTIVE, SUSPENDED
}
```
- **Response**:
```json
{
  "districtOfficerId": 1,
  "userId": 12345,
  "schoolIds": [100, 101, 102],
  "status": "ACTIVE",
  "created_at": "2023-11-28T07:00:00.000Z",
  "updated_at": "2023-11-28T07:00:00.000Z"
}
```

## 2. Get All District Officers
Retrieves a paginated list of district officers.

- **Endpoint**: `GET /district-officers`
- **Role Required**: ADMIN, DISTRICT, TEACHER, PRINCIPAL
- **Query Parameters**:
  - `page`: Page number (default: 1)
  - `limit`: Items per page (default: 10)
- **Response**:
```json
{
  "data": [
    {
      "districtOfficerId": 1,
      "userId": 12345,
      "schoolIds": [100, 101, 102],
      "status": "ACTIVE",
      "user": {
        "id": 12345,
        "username": "officer_01",
        "first_name": "Sophea",
        "last_name": "Chan",
        ...
      }
    }
  ],
  "total": 50,
  "page": 1,
  "limit": 10,
  "totalPages": 5
}
```

## 3. Get District Officer by ID
Retrieves details of a specific district officer.

- **Endpoint**: `GET /district-officers/:id`
- **Role Required**: ADMIN, DISTRICT, TEACHER, PRINCIPAL
- **Response**: District Officer object

## 4. Get by User ID
Finds the district officer record associated with a specific user ID.

- **Endpoint**: `GET /district-officers/user/:userId`
- **Role Required**: ADMIN, DISTRICT, TEACHER, PRINCIPAL

## 5. Get by School ID
Finds all district officers assigned to a specific school.

- **Endpoint**: `GET /district-officers/school/:schoolId`
- **Role Required**: ADMIN, DISTRICT, TEACHER, PRINCIPAL

## 6. Update District Officer
Updates the school assignments or status of a district officer.

- **Endpoint**: `PUT /district-officers/:id`
- **Role Required**: ADMIN, DISTRICT
- **Request Body**:
```json
{
  "schoolIds": [104, 105], // Optional: Replaces existing schools
  "status": "INACTIVE" // Optional
}
```
- **Response**: Updated District Officer object

## 7. Delete District Officer
Removes a district officer record (does not delete the user account).

- **Endpoint**: `DELETE /district-officers/:id`
- **Role Required**: ADMIN
- **Response**:
```json
{
  "message": "District officer with ID 1 has been successfully deleted"
}
```

## 8. Get Statistics
Retrieves summary statistics for district officers.

- **Endpoint**: `GET /district-officers/statistics`
- **Role Required**: ADMIN
- **Response**:
```json
{
  "totalOfficers": 50,
  "activeOfficers": 45,
  "inactiveOfficers": 5
}
```
